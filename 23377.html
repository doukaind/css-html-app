<!DOCTYPE html>
<html>

<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="applicable-device" content="pc,mobile"><meta http-equiv="Cache-Control" content="no-transform"/><meta http-equiv="Cache-Control" content="no-siteapp"/><title>Why shouldn&#39;t JSX props use arrow functions or bind? - H5W3</title><meta name="keywords" content=""/><meta name="description" content="I&#39;m running lint with my React app, and I receive this error:error    JSX props should not use arrow functions        react/jsx-no-bindAnd this is where I&#39;m running the arrow function (inside onClick):{this.state.photos.map(tile =&gt; (&lt;span key={tile.img}&gt;&lt;C"/><link rel="canonical" href="//www.h5w3.com/23377.html"><link rel="shortcut icon" href="/media/upload/img/defaultpic/1648222107_06071967.png" type=image/x-icon><link href="/static/css/comm.css" rel="stylesheet" type="text/css" media='screen'/><link href="/static/css/style.css" rel="stylesheet" type="text/css" media='screen'/><link href="/static/css/hlcss/monokai-sublime.css" rel="stylesheet" type="text/css" media='screen'><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8014733024256856" crossorigin="anonymous"></script></head><body><header id="header"><div id="header-container"><section id="header-content"><a href="/" id="logo-a"><img src="/media/upload/img/siteconf/1648222100_04216151.png" alt="H5W3LOGO" id="logo-pic"/></a></section><nav id="main-nav"><a href="//www.h5w3.com/"  class="nav-a nav-active" >首页</a><a href="/js/"  class="nav-a" >JavaScript</a><a href="/python/"  class="nav-a" >Python</a><a href="/java/"  class="nav-a" >Java</a><a href="/nginx/"  class="nav-a" >Nginx</a><a href="/php/"  class="nav-a" >PHP</a><a href="/linux/"  class="nav-a" >Linux</a><a href="/miniapp/"  class="nav-a" >小程序</a><a href="/qa/"  class="nav-a" >问答</a></nav></div></header><div id="main-body" class="clearfix"><div id="left"><nav id="bread-nav"><a href="/">首页</a> &gt;
                
                <span class="just-pc">Why shouldn&#39;t JSX props use arrow functions or bind?</span></nav><article id="article"><h1 class="h1">Why shouldn&#39;t JSX props use arrow functions or bind?</h1><ul class="article-meta"><li class="meta-li">H5W3</li><li class="meta-li">2020-06-12 04:58:12</li></ul><p><p>I'm running lint with my React app, and I receive this error:</p></p><p><pre><code>error    JSX props should not use arrow functions        react/jsx-no-bind</p><p></code></pre></p><p><p>And this is where I'm running the arrow function (inside <code>onClick</code>):</p></p><p><pre><code>{this.state.photos.map(tile =&gt; (</p><p>&lt;span key={tile.img}&gt;</p><p>&lt;Checkbox</p><p>defaultChecked={tile.checked}</p><p>onCheck={() =&gt; this.selectPicture(tile)}</p><p>style={{position: 'absolute', zIndex: 99, padding: 5, backgroundColor: 'rgba(255, 255, 255, 0.72)'}}</p><p>/&gt;</p><p>&lt;GridTile</p><p>title={tile.title}</p><p>subtitle={&lt;span&gt;by &lt;b&gt;{tile.author}&lt;/b&gt;&lt;/span&gt;}</p><p>actionIcon={&lt;IconButton onClick={() =&gt; this.handleDelete(tile)}&gt;&lt;Delete color="white"/&gt;&lt;/IconButton&gt;}</p><p>&gt;</p><p>&lt;img onClick={() =&gt; this.handleOpen(tile.img)} src={tile.img} style={{cursor: 'pointer'}}/&gt;</p><p>&lt;/GridTile&gt;</p><p>&lt;/span&gt;</p><p>))}</p><p></code></pre></p><p><p>Is this a bad practice that should be avoided? And what's the best way to do it?</p><h2>Answer</h2><p><strong>Why you shouldn't use inline arrow functions in JSX props</strong></p></p><p><p>Using arrow functions or binding in JSX is a bad practice that hurts performance, because the function is recreated on each render.</p></p><p><ol></p><p><li><p>Whenever a function is created, the previous function is garbage collected. Rerendering many elements might create jank in animations.</p></li></p><p><li><p>Using an inline arrow function will cause <code>PureComponent</code>s, and components that use <code>shallowCompare</code> in the <code>shouldComponentUpdate</code> method to rerender anyway. Since the arrow function prop is recreated each time, the shallow compare will identify it as a change to a prop, and the component will rerender.</p></li></p><p></ol></p><p><p>As you can see in the following 2 examples - when we use inline arrow function, the <code>&lt;Button&gt;</code> component is rerendered each time (the console shows the 'render button' text).</p></p><p><p><em>Example 1 - PureComponent <strong>without</strong> inline handler</em></p></p><p><p></p></p><p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="true"></p><p><div class="snippet-code snippet-currently-hidden"></p><p><pre class="snippet-code-js lang-js prettyprint-override"><code>class Button extends React.PureComponent {</p><p>  render() {</p><p>    const { onClick } = this.props;</p><p></p><p>    console.log('render button');</p><p></p><p>    return (</p><p>      &lt;button onClick={ onClick }&gt;Click&lt;/button&gt;</p><p>    );</p><p>  }</p><p>}</p><p>class Parent extends React.Component {</p><p>  state = {</p><p>    counter: 0</p><p>  }</p><p></p><p>  onClick = () =&gt; this.setState((prevState) =&gt; ({</p><p>    counter: prevState.counter + 1</p><p>  }));</p><p></p><p>  render() {</p><p>    const { counter } = this.state;</p><p></p><p>    return (</p><p>      &lt;div&gt;</p><p>        &lt;Button onClick={ this.onClick } /&gt;</p><p>        &lt;div&gt;{ counter }&lt;/div&gt;</p><p>      &lt;/div&gt;</p><p>    );</p><p>  }</p><p>}</p><p>ReactDOM.render(</p><p>  &lt;Parent /&gt;,</p><p>  document.getElementById('root')</p><p>);</code></pre></p><p><pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"&gt;&lt;/script&gt;</p><p>&lt;script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"&gt;&lt;/script&gt;</p><p>&lt;div id="root"&gt;&lt;/div&gt;</code></pre></p><p></div></p><p></div></p><p><p><em>Example 2 - PureComponent <strong>with</strong> inline handler</em></p></p><p><p></p></p><p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="true"></p><p><div class="snippet-code snippet-currently-hidden"></p><p><pre class="snippet-code-js lang-js prettyprint-override"><code>class Button extends React.PureComponent {</p><p>  render() {</p><p>    const { onClick } = this.props;</p><p></p><p>    console.log('render button');</p><p></p><p>    return (</p><p>      &lt;button onClick={ onClick }&gt;Click&lt;/button&gt;</p><p>    );</p><p>  }</p><p>}</p><p>class Parent extends React.Component {</p><p>  state = {</p><p>    counter: 0</p><p>  }</p><p></p><p>  render() {</p><p>    const { counter } = this.state;</p><p></p><p>    return (</p><p>      &lt;div&gt;</p><p>        &lt;Button onClick={ () =&gt; this.setState((prevState) =&gt; ({</p><p>          counter: prevState.counter + 1</p><p>        })) } /&gt;</p><p>        &lt;div&gt;{ counter }&lt;/div&gt;</p><p>      &lt;/div&gt;</p><p>    );</p><p>  }</p><p>}</p><p>ReactDOM.render(</p><p>  &lt;Parent /&gt;,</p><p>  document.getElementById('root')</p><p>);</code></pre></p><p><pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"&gt;&lt;/script&gt;</p><p>&lt;script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"&gt;&lt;/script&gt;</p><p>&lt;div id="root"&gt;&lt;/div&gt;</code></pre></p><p></div></p><p></div></p><p><p><strong>Binding methods to <code>this</code> without inlining arrow functions</strong></p></p><p><ol></p><p><li></p><p><p>Binding the method manually in the constructor:</p></p><p><pre><code>class Button extends React.Component {</p><p>  constructor(props, context) {</p><p>    super(props, context);</p><p>    this.cb = this.cb.bind(this);</p><p>  }</p><p>  cb() {</p><p>  }</p><p>  render() {</p><p>    return (</p><p>      &lt;button onClick={ this.cb }&gt;Click&lt;/button&gt;</p><p>    );</p><p>  }</p><p>}</p><p></code></pre></p><p></li></p><p><li></p><p><p>Binding a method using the proposal-class-fields with an arrow function. As this is  a stage 3 proposal, you'll need to add the Stage 3 preset or the Class properties transform to your babel configuration.</p></p><p><pre><code>class Button extends React.Component {</p><p>  cb = () =&gt; { // the class property is initialized with an arrow function that binds this to the class</p><p>  }</p><p>  render() {</p><p>    return (</p><p>      &lt;button onClick={ this.cb }&gt;Click&lt;/button&gt;</p><p>    );</p><p>  }</p><p>}</p><p></code></pre></p><p></li></p><p></ol></p><p><h2>Function Components with inner callbacks</h2></p><p><p>When we create an inner function (event handler for example) inside a function component, the function will be recreated every time the component is rendered. If the function is passed as props (or via context) to a child component (<code>Button</code> in this case), that child will re-render as well.</p></p><p><p><em>Example 1 - Function Component with an inner callback:</em></p></p><p><p></p></p><p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="true"></p><p><div class="snippet-code snippet-currently-hidden"></p><p><pre class="snippet-code-js lang-js prettyprint-override"><code>const { memo, useState } = React;</p><p>const Button = memo(({ onClick }) =&gt; console.log('render button') || (</p><p>  &lt;button onClick={onClick}&gt;Click&lt;/button&gt;</p><p>));</p><p>const Parent = () =&gt; {</p><p>  const [counter, setCounter] = useState(0);</p><p></p><p>  const increment = () =&gt; setCounter(counter =&gt; counter + 1); // the function is recreated all the time</p><p></p><p>  return (</p><p>    &lt;div&gt;</p><p>      &lt;Button onClick={increment} /&gt;</p><p></p><p>      &lt;div&gt;{counter}&lt;/div&gt;</p><p>    &lt;/div&gt;</p><p>  );</p><p>}</p><p>ReactDOM.render(</p><p>  &lt;Parent /&gt;,</p><p>  document.getElementById('root')</p><p>);</code></pre></p><p><pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"&gt;&lt;/script&gt;</p><p>&lt;script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"&gt;&lt;/script&gt;</p><p>&lt;div id="root"&gt;&lt;/div&gt;</code></pre></p><p></div></p><p></div></p><p><p>To solve this problem, we can wrap the callback with the <code>useCallback()</code> hook, and set the dependencies to an empty array.</p></p><p><p><strong>Note:</strong> the <code>useState</code> generated function accepts an updater function, that provides the current state. In this way, we don't need to set the current state a dependency of <code>useCallback</code>.</p></p><p><p><em>Example 2 - Function Component with an inner callback wrapped with useCallback:</em></p></p><p><p></p></p><p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="true"></p><p><div class="snippet-code snippet-currently-hidden"></p><p><pre class="snippet-code-js lang-js prettyprint-override"><code>const { memo, useState, useCallback } = React;</p><p>const Button = memo(({ onClick }) =&gt; console.log('render button') || (</p><p>  &lt;button onClick={onClick}&gt;Click&lt;/button&gt;</p><p>));</p><p>const Parent = () =&gt; {</p><p>  const [counter, setCounter] = useState(0);</p><p></p><p>  const increment = useCallback(() =&gt; setCounter(counter =&gt; counter + 1), []);</p><p></p><p>  return (</p><p>    &lt;div&gt;</p><p>      &lt;Button onClick={increment} /&gt;</p><p></p><p>      &lt;div&gt;{counter}&lt;/div&gt;</p><p>    &lt;/div&gt;</p><p>  );</p><p>}</p><p>ReactDOM.render(</p><p>  &lt;Parent /&gt;,</p><p>  document.getElementById('root')</p><p>);</code></pre></p><p><pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"&gt;&lt;/script&gt;</p><p>&lt;script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"&gt;&lt;/script&gt;</p><p>&lt;div id="root"&gt;&lt;/div&gt;</code></pre></p><p></div></p><p></div></p><p>以上是 <a href="/23377.html">Why shouldn&#39;t JSX props use arrow functions or bind?</a> 的全部内容，
                        来源链接：<a href="/23377.html">
                            www.h5w3.com/23377.html</a></p></article><div id="related-articles"><h4 class="h4">其他人也看了：</h4><div class="r-item-wrapper"></div></div><nav id="article-pager"><div class="pager-item txtover">
                    上一篇：
                    
                        无
                    
                </div><div class="pager-item txtover">
                    下一篇：
                    
                        无
                    
                </div></nav></div><aside class="sidebar just-pc sticky"><div class="tag-list"><h2 class="h2">热门推荐</h2><ol class="hot-list__ol"></ol></div></aside></div><footer id="footer"><div class="container just-pc"><div class="just-pc info"><h4>关于【H5W3】</h4><p>
                H5W3（www.h5w3.com），是一个专门分享IT技术知识、博文、问题回答的网站。<br/>
                大部分资料收集于互联网，如有侵权，可到201316775#qq.com反馈，我们将在第一时间处理。
            </p></div><div class="contact"><h4>联系我们</h4><p>E-mail：201316775#qq.com</p><p>商务合作：201316775（Q）</p><p>联系地址：Z星球D3幢</p></div><div class="ewm just-pc"><img src="/static/img/qrcode_www.h5w3.com.png" alt="手机站点二维码"/><p>扫码手机访问</p></div></div><div id="copyright">
        Copyright &copy; 2020 - 现在 H5W3 版权所有
        
        <span class="just-pc">&nbsp;&nbsp;ICP备案号：<a id="icp" href="http://www.beian.miit.gov.cn" rel="nofollow"
                                                     target="_blank"
                                                     title="ICP备案号"> 湘ICP备14008840号</a></span></div></footer><div id="top" onclick="returnTop()"><img id="top-pic" src="/static/img/top.svg" alt="回到顶部" title="返回顶部"/></div><script src="/static/js/comm.js"></script><script type="text/javascript">document.write(unescape("%3Cspan style='display:none;' id='cnzz_stat_icon_1278642705'%3E%3C/span%3E%3Cscript src='https://s4.cnzz.com/z_stat.php%3Fid%3D1278642705%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script><script src="/static/js/hljs/hl.js"></script><script>
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre').forEach((block) => {
            hljs.highlightBlock(block);});});
    </script></body>
</html>